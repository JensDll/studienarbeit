\chapter{Das RSA-Kryptosystem}
Das RSA-Kryptosystem ist eines der bekanntesten und meist
verbreiteten asymmetrischen Verschlüsselungsverfahren. Es ist benannt nach
den drei Erfindern Ronald Rivest, Adi Shamir und Leonard Adleman, welche das Verfahren
im Jahr 1977 veröffentli\-chten \parencite[173]{BOOK:crypto}. In diesem Kapitel
sollen die Ideen von asymmetrischer Verschlüsselung
(engl. \textit{public-key-crpytography} oder \textit{asymmetric crpytography})
vorgestellt werden. Es wird hierbei genauer auf das RSA-Kryptosystem eingegangen und
es werden einige zahlentheoretischen Grundlagen gezeigt.

\section{Asymmetrische Verschlüsselung}
Um die Idee der asymmetrischen Verschlüsselung besser zu verstehen,
ist es hilfreich auf das Prinzip der symmetrischen Verfahren zurückzukommen
(\autoref{fig:sym-encryption-revisit}).

\input{kapitel/rsa/tikz/sym-encryption.tex}

\noindent
Ein solches System hat zwei symmetrische Eigenschaften:
\begin{enumerate}[itemsep=0pt]
  \item Der selbe geheime Schlüssel wird sowohl für die
        Verschlüsselung als auch Entschlüsselung verwendet.
  \item Die Ver- und Entschlüsselungsfunktion sind sich sehr ähnlich
        (im Fall von \acs{otp} oder \acs{des} sind sie sogar gleich).
\end{enumerate}
Symmetrische Verfahren wie \acs{aes} sind sehr sicher und schnell,
jedoch kommen sie nicht ohne Defizite, wie im Folgenden beschrieben wird.

\paragraph{Schlüsselverteilungsproblem}
Da beide Parteien den selben Schlüssel benötigen, muss dieser in
irgendeiner Form untereinander verteilt werden.
Der direkte Austausch über die Schnittstelle ist nicht möglich, denn
die öffentliche Kommunikationsstrecke (unsicherer Kanal) ist nicht geschützt gegen Abhören.

\paragraph{Anzahl der Schlüssel}
Auch wenn das Schlüsselverteilungsproblem gelöst werden kann, entstehen
schnell Probleme, da die Anzahl der Schlüssel in einem
Netz mit zunehmender Teilnehmerzahl stark wächst. In einem Netz mit $n$
Teilnehmern, wobei jeder Teilnehmer mit jedem verschlüsselt kommunizieren soll, gibt es
\begin{equation*}
  \binom{n}{2} = \frac{n!}{2! \cdot (n-2)!} = \frac{n\cdot(n-1)}{2} \approx \frac{n^2}{2}
\end{equation*}
verschiedene Schlüsselpaare und jeder Teilnehmer muss $n-1$ Schlüssel speichern.
\begin{example}
  In einem Netz mit 500 Teilnehmern gibt es bereits $500 \cdot 499 / 2 = 124.750$ Schlüsselpaare
  und $500 \cdot 499 = 249.500$ Schlüssel müssen verteilt werden.
\end{example}
\noindent
Das Problem ist auch bekannt als das
$n^2$-Schlüsselverteilungsproblem \parencite[334-335]{BOOK:crypto}.

\paragraph{Schutz vor Betrug von Alice und Bob}
Es ist nur mit symmetrischer Verschlüsselung nicht möglich, einer dritten Person
zu beweisen, welcher Gesprächsteilnehmer eine Nachricht erstellt hat.
Es gibt jedoch viele Bereiche in denen dieser Beweis wichtig ist, beispielsweise
im Onlinehandel.
\begin{example}
  Alice betreibt einen Onlinehandel, sie muss beweisen können, dass ein
  Käufer Bob eine Bestellung wirklich getätigt hat, anderenfalls könnte Bob jederzeit behaupten
  Alice hätte seine Bestellung fälschlicherweise erstellt.
\end{example}
\noindent
Der Begriff um dies zu verhindern nennt sich Non-Repudiation \parencite{SITE:nonrepudiation}
und kann erreicht werden durch digitale Signaturen.
\par
Asymmetrische Verschlüsselungsverfahren bieten mögliche Lösungen zu den eben
beschriebenen Problemen, um eine Nachricht zu verschlüsseln ist es nicht mehr nötig,
dass der Absender in Besitz eines geheimen Schlüssels ist. Um solch ein System zu
realisieren veröffentlicht Bob einen öffentlichen Schlüssel. Dieser steht jedem Netzteilnehmer
zur Verfügung und kann frei verwendet werden.
Bob hat außerdem einen privaten Schlüssel, welchen nur er kennt.
Bob's Schlüssel $k$ besteht also aus einem öffentlichen Teil, $\keypub{}$ (\textit{key public}),
und einem private Teil, $\keypr{}$ (\textit{key private}). Wichtig ist, dass eine Nachricht
welche mit Bob's öffentlichen Schlüssel verschlüsselt wurde, nur auch mit Bob's privaten
Schlüssel wieder entschlüsselt werden kann. Ein einfaches Protokoll
welches nach diesem Prinzip arbeitet ist in \autoref{fig:asym-encr} zu sehen.

\input{kapitel/rsa/tikz/asym-encryption.tex}

\noindent
Ein Nachrichtenaustausch ist somit ohne sicheren Kanal möglich. Der oben beschriebene
Ablauf kann nun so modifiziert, um einen symmetrischen Schlüssel auszutauschen, beispielsweise
für \acs{aes}. Alice generiert einen symmetrischen Schlüssel und verschlüsselt ihn mit einem
asymmetrischen Verfahren. Bob kann die Nachricht entschlüsseln und ist somit ebenfalls
im Besitz des Schlüssels. Wie in \autoref{fig:asym-encr-key-exchange} zu sehen ist,
kann die restliche Kommunikation jetzt mit einem symmetrischen
Verfahren gesichert werden. Es ist wünschenswert nicht dauerhaft asymmetrisch
zu verschlüsseln, da dies im Gegensatz zu dem symmetrischen Gegenstück sehr viel
rechenintensiver ist.
\newpage

\input{kapitel/rsa/tikz/asym-encrpytion-key.tex}

\noindent
Asymmetrische Verfahren basieren alle auf einem zugrundeliegenden Prinzip:
Der Einwegfunktion oder auch Falltürfunktion genannt. Es kann folgende
Definition gegeben werden \parencite[153]{BOOK:crypto}:

\begin{definition}[Einwegfunktion]
  Eine Funktion $f$ ist eine Einwegfunktion, wenn gilt:
  \begin{enumerate}[itemsep=0pt]
    \item Der Funktionswert $y = f(x)$ ist komplexitätstheoretisch einfach berechenbar,
          d.h. die Laufzeit des Algorithmus wächst
          nicht stärker als eine Polynomfunktion (Polynomialzeit).
    \item Die Umkehrfunktion $x = f^{-1}(y)$ ist komplexitätstheoretisch schwierig berechenbar,
          d.h. es gibt keinen bekannten Algorithmus welcher das Problem in angemessener
          Zeit lösen kann, zum Beispiel in 1000 Jahren.
  \end{enumerate}
\end{definition}

\noindent
Es gibt zwei Einwegfunktionen welche in der Praxis häufig eingesetzt werden.
Die erste Funktion, welche in RSA verwendet wird,
basiert auf dem Faktorisierungsproblem großer natürlicher Zahlen.
Es ist einfach ein Produkt zu berechnen, jedoch ist es schwierig ein Produkt zu
faktorisieren. Die zweite Funktion basiert auf dem Lösen diskreter Logarithmen.
Warum das Lösen des Problems schwierig ist,
hat jedoch keine so intuitive Beschreibung.

\section{Zahlentheoretische Grundlagen für RSA}
In diesem Kapitel sollen die zahlentheoretischen Grundlagen beschrieben werden,
welche im RSA-Kryptosystem zum Einsatz kommen.

\subsection{Der Euklidische Algorithmus}
Es wird begonnen mit dem Begriff des größten gemeinsamen Teiler.
Es seien $a,b \in  \mathbb{N}$, es bezeichnet $T(a)$ die Menge aller Teiler von $a$,
dann heißt jedes $t \in T(a) \cap T(b)$ gemeinsamer Teiler von $a$ und $b$.

\begin{example}
  \begin{align*}
    T(6)           & = \{1,2,3,6\} \\
    T(4)           & = \{1,2,4\}   \\
    T(6) \cap T(4) & = \{1,2\}
  \end{align*}
\end{example}

\begin{definition}[Größter gemeinsamer Teiler]
  Es seien $a,b \in \mathbb{N}$.\\
  Es sei $T = T(a) \cap T(b)$.\\
  Es sei $g \in T$ und es gelte für alle $t \in T$: $t \leq g$. Dann heißt $g$
  größter gemeinsamer Teiler von $a$ und $b$.
  Man schreibt auch $g = \ggt{a}{b}$.
\end{definition}

\paragraph{Rechenregeln für ggT:}
Für $a,b \in \mathbb{N}$ gilt \parencite{SITE:euklid}:
\begin{enumerate}[itemsep=0pt]
  \item $\ggt{a}{a} = a$
  \item $\ggt{a}{1} = 1$
  \item $\ggt{a}{0} = a$
  \item $\ggt{a}{b} = \ggt{b}{a}$
  \item $\ggt{a}{b} = \ggt{a - b}{b}$
\end{enumerate}

\begin{proof}\mbox{}
  \begin{enumerate}[itemsep=0pt]
    \item Wegen $T(a) \cap T(a) = T(a)$
    \item Wegen $T(1) = \{1\}$ und $T(a) \cap \{1\} = \{1\}$
    \item Wegen $T(0) = \mathbb{N}$ und $T(a) \cap \mathbb{N} = T(a)$
    \item Wegen der Kommutativität der Schnittmenge $T(a) \cap T(b) = T(b)\cap T(a)$
  \end{enumerate}
\end{proof}